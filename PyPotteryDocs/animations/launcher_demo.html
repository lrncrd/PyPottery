<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyPottery Launcher Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f3f4f6;
            font-family: 'Segoe UI', 'Roboto', Helvetica, Arial, sans-serif;
            overflow: hidden;
        }

        /* Variables */
        :root {
            --primary: #667eea;
            --success: #10b981;
            --bg-color: #f8fafc;
            --border-color: #e5e7eb;
        }

        .window {
            width: 950px;
            height: 850px;
            background: var(--bg-color);
            border-radius: 10px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            transform: scale(0.75);
            transform-origin: center;
        }

        .title-bar {
            height: 32px;
            background: #e3e3e3;
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 8px;
            border-bottom: 1px solid #d1d5db;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot.red {
            background: #ff5f57;
            border: 1px solid #e0443e;
        }

        .dot.yellow {
            background: #febc2e;
            border: 1px solid #d89e24;
        }

        .dot.green {
            background: #28c840;
            border: 1px solid #1aab29;
        }

        .app-body {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .panel {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .panel-header {
            padding: 12px 16px 8px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 14px;
            font-weight: 700;
            color: #374151;
        }

        .panel-content {
            padding: 0 16px 16px 16px;
        }

        .btn {
            padding: 6px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-purple {
            background-color: #764ba2;
            color: white;
        }

        .btn-disabled {
            background-color: #e5e7eb;
            color: #9ca3af;
            cursor: not-allowed;
        }

        /* App Details */
        .app-details {
            display: flex;
            gap: 15px;
            margin: 8px 0;
            color: #9ca3af;
            font-size: 10px;
        }

        /* Console */
        .console-header {
            background: #f1f5f9;
            height: 32px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .console-body {
            background: #1e1e2e;
            height: 120px;
            padding: 8px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: #cdd6f4;
            line-height: 1.5;
        }

        .hw-row {
            display: flex;
            padding: 4px 0;
            font-size: 11px;
        }

        .hw-label {
            width: 70px;
            font-weight: 700;
            color: var(--primary);
        }

        .hw-val {
            color: #4b5563;
        }

        /* Cursor - Better SVG for precision */
        .cursor {
            width: 18px;
            height: 24px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="24" viewBox="0 0 18 24"><path fill="black" stroke="white" stroke-width="1" d="M0,0 L0,20 L5,16 L9,24 L12,22 L8,15 L14,14 Z"/></svg>') no-repeat;
            position: absolute;
            top: 110%;
            left: 110%;
            z-index: 9999;
            /* Improved transition for mouse-like feel */
            transition: top 0.6s cubic-bezier(0.22, 1, 0.36, 1), left 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.3));
            pointer-events: none;
        }

        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
            display: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .modal-content {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: scale(0.95);
            transition: transform 0.2s;
        }

        /* Simplified App Window */
        .browser-window {
            z-index: 200;
        }
    </style>
</head>

<body>

    <div class="window" id="appWindow">
        <div class="title-bar">
            <div class="dot red"></div>
            <div class="dot yellow"></div>
            <div class="dot green"></div>
            <div style="margin-left: auto; margin-right: auto; font-size: 13px; color: #4b5563; font-weight: 500;">
                PyPottery Suite Launcher v1.0.0</div>
        </div>

        <div class="app-body">
            <div class="grid grid-cols-12 gap-5">
                <!-- Left Column -->
                <div class="col-span-12 lg:col-span-5 flex flex-col gap-5">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">üíª System Information</div>
                        </div>
                        <div class="panel-content">
                            <div class="hw-row"><span class="hw-label">OS:</span><span class="hw-val">macOS 14.2
                                    (arm64)</span></div>
                            <div class="hw-row"><span class="hw-label">CPU:</span><span class="hw-val">Apple M2 Pro (10
                                    cores)</span></div>
                            <div class="hw-row"><span class="hw-label">RAM:</span><span class="hw-val">32.0 GB total,
                                    18.5 GB free</span></div>
                            <div class="hw-row"><span class="hw-label">GPU:</span><span class="hw-val">‚úÖ Apple Silicon
                                    (MPS)</span></div>
                            <div class="hw-row"><span class="hw-label">PyTorch:</span><span class="hw-val">Recommended:
                                    MPS (Metal)</span></div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">üêç Python Environment</div>
                            <span id="envStatus" class="text-[11px] text-gray-500">Not configured</span>
                        </div>
                        <div class="panel-content">
                            <div class="w-full bg-gray-200 rounded h-2 mb-2 overflow-hidden">
                                <div id="envProgress"
                                    class="h-full bg-[#667eea] w-0 transition-all duration-100 ease-linear"></div>
                            </div>
                            <div id="envProgressText" class="text-[10px] text-gray-500 h-4 mb-2"></div>
                            <div class="flex gap-2">
                                <button id="setupBtn" class="btn btn-primary">Setup Environment</button>
                                <button class="btn btn-purple w-20">Verify</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="col-span-12 lg:col-span-7 flex flex-col gap-4">
                    <div class="panel">
                        <div class="panel-header !pb-0">
                            <div class="flex items-center gap-3 w-full">
                                <div class="text-3xl">‚úíÔ∏è</div>
                                <div class="flex-1">
                                    <h3 class="font-bold text-gray-800 text-base">PyPotteryInk</h3>
                                    <p class="text-[11px] text-gray-500">AI-based inking of pottery drawings</p>
                                </div>
                                <span id="inkStatus" class="bg-gray-200 text-gray-500 text-[10px] px-2 py-1 rounded">Not
                                    installed</span>
                            </div>
                        </div>
                        <div class="panel-content !pt-0">
                            <div class="app-details">
                                <span>Port: 8001</span>
                                <span>RAM: 4GB min</span>
                                <span>GPU required</span>
                            </div>
                            <div class="flex items-center mt-3">
                                <div class="flex gap-2">
                                    <button id="inkInstallBtn" class="btn btn-disabled w-24">Install</button>
                                    <button id="inkLaunchBtn" class="btn btn-disabled w-24 hidden">Launch</button>
                                    <button class="btn btn-disabled w-20">Stop</button>
                                    <button class="btn btn-disabled w-20">Update</button>
                                </div>
                                <button class="ml-auto btn bg-gray-200 text-gray-700 w-10">üìÅ</button>
                            </div>
                        </div>
                    </div>

                    <div class="panel opacity-80">
                        <div class="panel-header !pb-0">
                            <div class="flex items-center gap-3 w-full">
                                <div class="text-3xl">üìê</div>
                                <div class="flex-1">
                                    <h3 class="font-bold text-gray-800 text-base">PyPotteryLayout</h3>
                                    <p class="text-[11px] text-gray-500">Create publication-ready layouts</p>
                                </div>
                                <span class="bg-gray-200 text-gray-500 text-[10px] px-2 py-1 rounded">Not
                                    installed</span>
                            </div>
                        </div>
                        <div class="panel-content !pt-0">
                            <div class="app-details">
                                <span>Port: 8002</span>
                                <span>RAM: 2GB min</span>
                                <span>CPU OK</span>
                            </div>
                            <div class="flex items-center mt-3">
                                <div class="flex gap-2">
                                    <button class="btn btn-disabled w-24">Install</button>
                                    <button class="btn btn-disabled w-20">Stop</button>
                                </div>
                                <button class="ml-auto btn btn-disabled w-10">üìÅ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel flex-1 flex flex-col min-h-0">
                <div class="console-header">
                    <span class="text-[11px] font-bold text-[#667eea]">‚óè Console</span>
                    <button class="ml-auto px-2 py-0.5 bg-gray-200 text-gray-600 rounded text-[10px]">Clear</button>
                </div>
                <div class="console-body" id="consoleOutput">
                    <div class="text-gray-500">[System] Launcher started successfully.</div>
                    <div class="text-gray-500">[System] Detecting hardware...</div>
                    <div class="text-[#89b4fa]">[info] Hardware detection complete. found Apple M2 Pro.</div>
                </div>
            </div>
        </div>

        <div id="downloadModal" class="modal-overlay absolute inset-0 z-50 flex items-center justify-center">
            <div class="modal-content bg-[#f8fafc] w-[480px] p-6 rounded-xl border border-gray-200 shadow-2xl">
                <div class="flex items-center gap-4 mb-4">
                    <span class="text-4xl">üì¶</span>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg text-gray-800">Installing PyPotteryInk</h3>
                        <p id="dlStatus" class="text-sm text-gray-500">Preparing download...</p>
                    </div>
                </div>
                <div class="w-full bg-gray-200 rounded h-3 overflow-hidden mb-1">
                    <div id="dlProgress" class="h-full bg-[#667eea] w-0"></div>
                </div>
                <div id="dlDetails" class="text-xs text-center text-gray-500 mb-6">0%</div>
                <div class="flex justify-center">
                    <button id="dlCloseBtn" class="btn btn-disabled w-24">Close</button>
                </div>
            </div>
        </div>

        <!-- Simulated App Window (Simplified) -->
        <div id="browserWindow"
            class="browser-window absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[850px] h-[600px] bg-white rounded-lg shadow-2xl opacity-0 transform scale-90 transition-all duration-500 pointer-events-none flex flex-col border border-gray-200">
            <div class="bg-gray-100 border-b border-gray-300 px-3 py-2 flex items-center gap-3 rounded-t-lg">
                <div class="flex gap-1.5">
                    <div class="w-2.5 h-2.5 rounded-full bg-red-400 border border-red-500"></div>
                    <div class="w-2.5 h-2.5 rounded-full bg-yellow-400 border border-yellow-500"></div>
                    <div class="w-2.5 h-2.5 rounded-full bg-green-400 border border-green-500"></div>
                </div>
                <div
                    class="flex-1 bg-white border border-gray-300 rounded px-2 py-0.5 text-xs text-gray-600 flex items-center gap-2">
                    <svg width="10" height="10" fill="gray" viewBox="0 0 24 24">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
                    </svg>
                    http://localhost:8001
                </div>
            </div>
            <!-- Simple Content -->
            <div
                class="flex-1 bg-white flex flex-col items-center justify-center animate-fade-in relative overflow-hidden">
                <!-- Background pattern -->
                <div class="absolute inset-0 opacity-[0.03]"
                    style="background-image: radial-gradient(#667eea 1px, transparent 1px); background-size: 20px 20px;">
                </div>

                <div class="text-8xl mb-6 text-[#667eea] animate-bounce">‚úíÔ∏è</div>
                <div class="text-4xl font-bold text-gray-800 mb-4 tracking-tight">PyPotteryInk</div>
                <div class="text-gray-400 font-mono text-sm">v1.2.0 ‚Ä¢ Ready</div>
            </div>
        </div>

        <div id="cursor" class="cursor"></div>
    </div>

    <script>
        const qs = (s) => document.querySelector(s);
        const cursor = qs('#cursor');
        const setupBtn = qs('#setupBtn');
        const envProgress = qs('#envProgress');
        const envProgressText = qs('#envProgressText');
        const envStatus = qs('#envStatus');
        const inkInstallBtn = qs('#inkInstallBtn');
        const inkLaunchBtn = qs('#inkLaunchBtn');
        const inkStatus = qs('#inkStatus');
        const modal = qs('#downloadModal');
        const dlProgress = qs('#dlProgress');
        const dlStatus = qs('#dlStatus');
        const dlDetails = qs('#dlDetails');
        const dlCloseBtn = qs('#dlCloseBtn');
        const browser = qs('#browserWindow');
        const consoleOutput = qs('#consoleOutput');
        const appWindow = qs('#appWindow');

        function log(msg, type = 'info') {
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            let color = '#cdd6f4';
            let prefix = '‚Ä¢';
            if (type === 'info') { color = '#89b4fa'; prefix = '‚Ä¢'; }
            if (type === 'success') { color = '#a6e3a1'; prefix = '‚úì'; }
            if (type === 'progress') { color = '#cba6f7'; prefix = '‚óã'; }
            if (type === 'warning') { color = '#f9e2af'; prefix = '‚ñ≤'; }

            const line = document.createElement('div');
            line.innerHTML = `<span style="color:#6b7280">[${time}]</span> <span style="color:${color}">${prefix}</span> ${msg}`;
            consoleOutput.appendChild(line);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        // Precise offset calculation
        function getTargetPos(el) {
            const r = el.getBoundingClientRect();
            const w = appWindow.getBoundingClientRect();
            const scale = 0.75;
            return {
                x: ((r.left - w.left) + (r.width / 2)) / scale,
                y: ((r.top - w.top) + (r.height / 2)) / scale
            };
        }

        async function moveCursor(el) {
            const pos = getTargetPos(el);
            cursor.style.top = pos.y + 'px';
            cursor.style.left = pos.x + 'px';
            await wait(700);

            // Click animation
            el.style.transform = 'scale(0.95)';
            setTimeout(() => el.style.transform = '', 150);
            await wait(200);
        }

        function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

        async function sequence() {
            reset();
            await wait(1000);

            // 1. Setup Environment
            await moveCursor(setupBtn);

            setupBtn.innerText = "Installing...";
            envProgressText.innerText = "Creating virtual environment...";
            log("Creating virtual environment...", "progress");

            envProgress.style.transition = 'width 1s ease-out';
            envProgress.style.width = '30%';
            await wait(1000);

            envProgressText.innerText = "Installing dependencies...";
            log("Installing requirements...", "progress");
            envProgress.style.width = '80%';
            await wait(1200);

            envProgress.style.width = '100%';
            envStatus.innerText = "‚úÖ Ready";
            envStatus.className = "text-[11px] text-[#10b981] font-medium";
            envProgressText.innerText = "";
            setupBtn.innerText = "Reinstall"; // Confirmed behavior
            setupBtn.className = "btn btn-disabled";
            log("Environment configured successfully!", "success");

            inkInstallBtn.className = "btn btn-primary w-24";

            await wait(800);

            // 2. Install App
            await moveCursor(inkInstallBtn);

            modal.style.display = 'flex';
            setTimeout(() => {
                modal.style.opacity = '1';
                qs('.modal-content').style.transform = 'scale(1)';
            }, 50);

            const modalPos = { x: 475, y: 350 };
            cursor.style.top = modalPos.y + 'px';
            cursor.style.left = modalPos.x + 'px';

            log("Downloading PyPotteryInk...", "info");

            for (let i = 0; i <= 100; i += 2) {
                dlProgress.style.width = i + '%';
                dlDetails.innerText = i + '% - ' + (i * 0.5).toFixed(1) + ' MB / 50.0 MB';
                if (i == 40) dlStatus.innerText = "Extracting files...";
                await wait(20);
            }

            dlStatus.innerText = "‚úÖ Installation Complete";
            dlStatus.className = "text-sm text-green-500 font-bold";
            dlProgress.style.backgroundColor = "#10b981";
            dlCloseBtn.className = "btn btn-primary w-24";
            log("PyPotteryInk installed v1.2.0", "success");

            await wait(500);
            await moveCursor(dlCloseBtn);

            modal.style.opacity = '0';
            qs('.modal-content').style.transform = 'scale(0.95)';
            setTimeout(() => modal.style.display = 'none', 200);

            inkStatus.innerText = "Installed";
            inkStatus.className = "bg-blue-100 text-blue-700 text-[10px] px-2 py-1 rounded";
            inkInstallBtn.classList.add('hidden');
            inkLaunchBtn.classList.remove('hidden', 'btn-disabled');
            inkLaunchBtn.classList.add('btn-success', 'flex');

            await wait(800);

            // 3. Launch App
            await moveCursor(inkLaunchBtn);
            log("Launching PyPotteryInk...", "info");

            await wait(300);
            browser.style.opacity = '1';
            browser.style.transform = 'translate(-50%, -50%) scale(1)';

            await wait(3000);

            browser.style.opacity = '0';
            browser.style.transform = 'translate(-50%, -50%) scale(0.9)';
            cursor.style.top = '110%';
            cursor.style.left = '110%';
            log("App stopped.", "warning");

            await wait(1500);
            sequence();
        }

        function reset() {
            envStatus.innerText = "Not configured";
            envStatus.className = "text-[11px] text-gray-500";
            envProgress.style.transition = 'none';
            envProgress.style.width = '0';
            setupBtn.innerText = "Setup Environment";
            setupBtn.className = "btn btn-primary";

            inkStatus.innerText = "Not installed";
            inkStatus.className = "bg-gray-200 text-gray-500 text-[10px] px-2 py-1 rounded";
            inkInstallBtn.classList.remove('hidden');
            inkLaunchBtn.classList.add('hidden');
            inkInstallBtn.className = "btn btn-disabled w-24";

            dlProgress.style.width = '0%';
            dlProgress.style.backgroundColor = '#667eea';
            dlStatus.innerText = "Preparing download...";
            dlStatus.className = "text-sm text-gray-500";
            dlCloseBtn.className = "btn btn-disabled w-24";

            consoleOutput.innerHTML = '';
            log("[System] Launcher started successfully.");
            log("[System] Detecting hardware...");
            log("[info] Hardware detection complete. found Apple M2 Pro.");
        }

        setTimeout(sequence, 1000);
    </script>
</body>

</html>