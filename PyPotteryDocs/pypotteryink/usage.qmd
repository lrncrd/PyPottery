---
title: "Using PyPotteryInk"
format: html
toc: true
---

<div style="text-align: center;">
  <img src="../imgs/LogoInk.png" id="fig-loading_screen" style="max-width: 25%; height: auto; margin-bottom: 1em;">
  <br>
  </span>
</div>

```{=html}
<div style="
    background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
    border: 1px solid #e1e4e8;
    border-left: 5px solid #667eea;
    border-radius: 12px;
    padding: 15px 25px;
    margin: 20px 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
">
    <div style="font-family: 'Segoe UI', sans-serif; color: #4a5568; max-width: 70%;">
        <div style="font-size: 1.25em; font-weight: 700; color: #2d3748; margin-bottom: 5px;">
            Need a hand?
        </div>
        <div style="line-height: 1.5;">
            Look for <strong style="color: #667eea;">Pixel</strong> in the app! <br>
            Clicking on him brings you straight back to this guide.
        </div>
    </div>
    <div style="flex-shrink: 0; display: flex; align-items: center; justify-content: center;">
         <iframe src="../animations/pixel_assistant.html" style="width: 220px; height: 120px; border: none; overflow: hidden;" scrolling="no"></iframe>
    </div>
</div>
```

# Interface Overview

The PyPotteryInk interface is divided into four main tabs:

- **Hardware Check**
- **Model Diagnostic**
- **Preprocessing**
- **Batch Processing**

Additionally, you can toggle **Dark Mode** using the button in the interface.

# Hardware Check

This tab allows you to analyze your PC's hardware to verify compatibility with PyPotteryInk.

<iframe src="animations/hardware_check.html" scrolling="no" style="width: 100%; height: 900px; border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 20px 0; overflow: hidden;"></iframe>

The page displays **Recommended Specifications**, indicating the minimum requirements to use the program.

Clicking on **üîç Check Hardware** will display your machine's specifications along with a performance score.

# Preprocessing

This tab allows you to process images by adjusting statistics (contrast, etc.) to fit within a range known by the model.

<iframe src="animations/preprocessing.html" scrolling="no" style="width: 100%; height: 980px; border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 20px 0; overflow: hidden;"></iframe>

You can use an existing `.npy` file to apply the statistics to the images.

PyPotteryInk provides two default `.npy` files:

- `Montale_stats.npy` (Metric measures of the dataset used to train the 6h-MCG model)
- `Cimino_stats.npy` (Metric measures of the dataset used to train the 6h-MC model)

In short, these metrics can be used to make your images resemble those used to train the model.

The **Output Directory** text box allows you to indicate where the modified images will be saved.
Click **‚ú® Apply Preprocessing** to start. A progress bar will indicate the status.


::: {.callout-note}
In the "Advanced" section, you can calculate statistics from a set of images. Uploading is done in the same way as the previous tab.
The **Save Statistics As** text box allows you to decide the path and name of the `.npy` file.
Click **üìä Calculate Statistics** to perform the calculation.
:::


# Model Diagnostic

This tab allows you to test the model on a single image to verify its operation and determine the best parameters for batch processing.

<iframe src="animations/model_diagnostic.html" scrolling="no" style="width: 100%; height: 660px; border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 20px 0; overflow: hidden;"></iframe>

The available elements are:

- **Select Model**: Allows you to select the model to use (see the Model Zoo section for details). The model will be automatically downloaded during processing.
- **Patch Size**: Determines the size of the "chunks" the image is divided into for processing. Refer to the dedicated documentation section.
- **Upload Images**: This window allows you to upload images. You can use drag-and-drop or a dialog window. Once uploaded, images are displayed as thumbnails.
- **Overlap**: Determines the number of pixels where patches overlap. Refer to the dedicated documentation section.
- **Contrast Test Values**: The model will generate an enhancement using the indicated values. To add a contrast value for evaluation, separate it with a comma.

Clicking on **üöÄ Run Diagnostic** will start the process, and a progress bar will indicate advancement.
At the end of the process, a gallery will allow you to view the results.

# Batch Processing

This tab represents the core of the program where you can process a series of images.

<iframe src="animations/batch_processing.html" scrolling="no" style="width: 100%; height: 880px; border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 20px 0; overflow: hidden;"></iframe>

Parameters like **Select Model**, **Upload Images**, **Patch Size**, and **Overlap** are the same as in the Preprocessing tab.

New parameters include:

- **Output Directory**: Allows you to indicate where to save the results.
- **Contrast Scale**: Allows you to indicate the contrast value to apply to the batch.
- **Scale Factor**: Allows you to temporarily apply upsampling or downsampling to the images. After processing, images will be saved in their original dimensions, so there is no need to rescale them manually.
- **Use FP16**: Allows you to apply the model using half-precision (requires CUDA).

Clicking on **üöÄ Start Processing** will start the operation. A double progress bar will indicate the processing of patches and drawings.
The results will be shown in a gallery.
